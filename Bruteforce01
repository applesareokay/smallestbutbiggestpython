aW1wb3J0IHRpbWUKaW1wb3J0IHJlcGxpdAppbXBvcnQgaXRlcnRvb2xzCmltcG9ydCBzdHJpbmcKaW1wb3J0IHJlcXVlc3RzIGFzIHRpbWVyCmltcG9ydCByYW5kb20KaW1wb3J0IGJhc2U2NApnbG9iYWwgYW1tdApnbG9iYWwgYWxwaGFiZXQKZ2xvYmFsIG1vZGlmeVRpbWVyCmdsb2JhbCBmYWtlYW1tdApnbG9iYWwgdG9nZXR0bwpnbG9iYWwgZXJyb3IKZ2xvYmFsIGRvcmFuZG9tCmdsb2JhbCByZXN1bHRzbm8KcmVzdWx0c25vID0gRmFsc2UKZG9yYW5kb20gPSAnbicKZXJyb3IgPSAnbicKdG9nZXR0byA9IHJhbmRvbS5yYW5kcmFuZ2UoMzApCmZha2VhbW10ID0gMQptb2RpZnlUaW1lciA9ICduJwphbW10ID0gMQphbHBoYWJldCA9ICcgYUFlRWlJb091VXlZYkJjQ2REZkZnR2hIakprS2xMbU1uTnBQcVFyUnNTdFR2VndXeFh6WiFAIyQlXiYqKCkxMjM0NTY3ODkwe31bXVx8OzoiLz8uPiw8JwpnbG9iYWwgaG93aXRlbmRlZCAgCmhvd2l0ZW5kZWQgPSAnTlVMJyAgCgpkZWYgZW5kKCk6CiAgICAgICAgZ2xvYmFsIHN0YXJ0X3RpbWUKICAgICAgICBnbG9iYWwgaG93aXRlbmRlZAogICAgICAgIGdsb2JhbCBzaG93cGFzc3dvcmQKICAgICAgICBnbG9iYWwgbW9kaWZ5VGltZXIKICAgICAgICBnbG9iYWwgcGFzc3dvcmQKICAgICAgICBnbG9iYWwgcmVzdWx0c25vCiAgICAgICAgZW5kX3RpbWUgPSB0aW1lLnRpbWUoKQogICAgICAgIHRpbWVfbGFwc2VkID0gZW5kX3RpbWUgLSBzdGFydF90aW1lCiAgICAgICAgcmVwbGl0LmNsZWFyKCkKICAgICAgICBwcmludCgnKicgKiAyMCkKICAgICAgICBpZiBtb2RpZnlUaW1lciA9PSAneSc6CiAgICAgICAgICBwYXNzd29yZCA9ICdTMlZsY0NCMGFHbHpJR0VnYzJWamNtVjBJUScKICAgICAgICAgIHBhc3N3b3JkID0gYmFzZTY0LmI2NGRlY29kZShwYXNzd29yZCArICc9PScpLmRlY29kZSgndXRmLTgnKQogICAgICAgIHByaW50KCdQYXNzd29yZCBmb3VuZDogJXMnICUgcGFzc3dvcmQpCiAgICAgICAgaWYgbW9kaWZ5VGltZXIgPT0gJ3knOgogICAgICAgICAgdGltZV9sYXBzZWQgPSAnOiknCiAgICAgICAgcHJpbnQoZidUaW1lIHRvb2s6IHt0aW1lX2xhcHNlZH0nKQogICAgICAgIGlmIHBhc3N3b3JkID09ICdwZW5pcyc6CiAgICAgICAgICBob3dpdGVuZGVkID0gJ1RvbyBTaG9ydCBPZiBhIFBhc3N3b3JkJwogICAgICAgIGVsc2U6CiAgICAgICAgICBob3dpdGVuZGVkID0gaG93aXRlbmRlZAogICAgICAgIHByaW50KCdIb3c6JywgaG93aXRlbmRlZCkKICAgICAgICBwcmludCgnKicgKiAyMCkKICAgICAgICBpZiByZXN1bHRzbm8gPT0gRmFsc2U6CiAgICAgICAgICByZXN1bHRzID0gb3BlbignUmVzdWx0cy50eHQnLCAnYScpCiAgICAgICAgICByZXN1bHRzLndyaXRlKCdcclxuJykKICAgICAgICAgIHJlc3VsdHMud3JpdGUoJyonICogMjApCiAgICAgICAgICByZXN1bHRzLndyaXRlKCdcclxuJykKICAgICAgICAgIHBhc2xlbiA9IGxlbihwYXNzd29yZCkKICAgICAgICAgIGdsb2JhbCBkb3JhbmRvbQogICAgICAgICAgaWYgZG9yYW5kb20gPT0gJ3knOgogICAgICAgICAgICB0aW1lX2xhcHNlZCA9IHJhbmRvbS5yYW5kcmFuZ2UoNTA2MSkKICAgICAgICAgIGlmIHNob3dwYXNzd29yZCA9PSAneSc6CiAgICAgICAgICAgIHJlc3VsdHMud3JpdGUoZidQYXNzd29yZCAoU2hvd24gYmVjYXVzZSBvZiByZXF1ZXN0KToge3Bhc3N3b3JkfVxyXG4nKQogICAgICAgICAgZWxzZToKICAgICAgICAgICAgcmVzdWx0cy53cml0ZShmJ1Bhc3N3b3JkIGxlbmd0aDogeyLCtyIgKiBwYXNsZW59XHJcbicpCiAgICAgICAgICAgIHJlc3VsdHMud3JpdGUoZidUaW1lIHRvb2s6IHt0aW1lX2xhcHNlZH1cclxuJykKICAgICAgICAgICAgcmVzdWx0cy53cml0ZShmJ1dheSBvZiBiZWluZyBmb3VuZDoge2hvd2l0ZW5kZWR9XHJcbicpCiAgICAgICAgICAgIHJlc3VsdHMud3JpdGUoJyonICogMjApCiAgICAgICAgICAgIHJlc3VsdHMuY2xvc2UoKQogICAgICAgIHRpbWUuc2xlZXAoMTApCiAgICAgICAgZXhpdCgwKQpkZWYgbW92ZU9uKCk6CiAgZmlyc3RfaGFsZl9wYXNzd29yZCA9ICcnCiAgZ2xvYmFsIGFscGhhYmV0CiAgZ2xvYmFsIGFtbXQKICBnbG9iYWwgcGFzc3dvcmQKICBnbG9iYWwgdGltZV9zdGFydAogIGdsb2JhbCBzdGFydF90aW1lCiAgZ2xvYmFsIHRvZ2V0dG8KICBnbG9iYWwgZmFrZWFtbXQKICBnbG9iYWwgZG9yYW5kb20KICBmb3IgYyBpbiBpdGVydG9vbHMucHJvZHVjdChhbHBoYWJldCwgcmVwZWF0PWFtbXQpOgogICAgcGFzc3dvcmQydGVzdCA9IGZpcnN0X2hhbGZfcGFzc3dvcmQrJycuam9pbihjKQogICAgaWYgcGFzc3dvcmQydGVzdCA9PSBwYXNzd29yZDoKICAgICAgZ2xvYmFsIGhvd2l0ZW5kZWQKICAgICAgaG93aXRlbmRlZCA9ICdCcnV0ZWZvcmNlIGF0dGFjaycKICAgICAgZW5kKCkKICBnbG9iYWwgZXJyb3IKICBpZiBlcnJvciA9PSAneSc6CiAgICBwcmludCgnQnJ1dGUgZm9yY2UgbGVuZ3RoIGluY3JlYXNlZCB0bycsIGZha2VhbW10KQogICAgdGltZS5zbGVlcCgxKQogICAgaWYgZmFrZWFtbXQgPT0gdG9nZXR0bzoKICAgICAgdGltZS5zbGVlcCgxMCkKICAgICAgcGFzc3dvcmQgPSAnTklMJwogICAgICBob3dpdGVuZGVkID0gJ1FuSjFkR1ZtYjI5dGJXOXVJSGRzYVhNZ2IzSjBaQScKICAgICAgaG93aXRlbmRlZCA9IGJhc2U2NC5iNjRkZWNvZGUoaG93aXRlbmRlZCArICc9PScpLmRlY29kZSgndXRmLTgnKQogICAgICBkb3JhbmRvbSA9ICd5JwogICAgICBlbmQoKQogICAgZmFrZWFtbXQgKz0gMQogICAgbW92ZU9uKCkKICBhbW10ICs9IDEKICBwcmludCgnQnJ1dGUgZm9yY2UgbGVuZ3RoIGluY3JlYXNlZCB0bycsIGFtbXQpCiAgbW92ZU9uKCkKZGVmIHJ1blBhc3N3b3JkVGhyb3VnaEZpbGUoKToKICBnbG9iYWwgcGFzc3dvcmQKICB3aXRoIG9wZW4oJ3JvY2t5b3UudHh0JywgJ3InKSBhcyByZWFkX29iajoKICAgIGZvciBsaW5lIGluIHJlYWRfb2JqOgogICAgICAgICNMaXN0IG9mIHdvcmRzICh3aXRob3V0IHB1bmN0dWF0aW9uKQogICAgICAgIHdvcmRzID0gW3dvcmQuc3RyaXAoc3RyaW5nLnB1bmN0dWF0aW9uKSBmb3Igd29yZCBpbiBsaW5lLnNwbGl0KCldCiAgICAgICAgaWYgcGFzc3dvcmQgaW4gd29yZHM6CiAgICAgICAgICBwcmludCgnRm91bmQgcGFzc3dvcmQgaW4gY29tbW9uIHBhc3N3b3JkIGxpc3QnKQogICAgICAgICAgZ2xvYmFsIGhvd2l0ZW5kZWQKICAgICAgICAgIGhvd2l0ZW5kZWQgPSAnQ29tbW9uIHBhc3N3b3JkIGZpbGUnCiAgICAgICAgICBlbmQoKQogICAgcHJpbnQoJ1Bhc3N3b3JkIG5vdCBmb3VuZCBpbiBjb21tb24gcGFzc3dvcmQgbGlzdCwgbW92aW5nIG9udG8gYnJ1dGUgZm9yY2UnKQogICAgbW92ZU9uKCkKcHJpbnQoIkVudGVyIHRoZSBwYXNzd29yZCB5b3Ugd2FudCB0byBzdHJlbmd0aCB0ZXN0LiIpCnByaW50KCJXZSBoYXZlIG5vIGNsdWUgd2hvIHlvdSBhcmUsIGFuZCB0aGlzIHByb2plY3QgaXMgb3BlbiBzb3VyY2UuIikKcHJpbnQoJ1lvdSBjYW4gYWRkIG9uIGEgIi1yZXN1bHQiIHRvIHRoZSBlbmQgb2YgeW91ciBwYXNzd29yZCBhbmQgaXQgd2lsbCBzaG93IGl0IGluIHRoZSByZXN1bHRzIGZpbGUuJykKcHJpbnQoJ09yLCBpZiB5b3UgbmV2ZXIgd2FudCB0byBzZWUgdGhpcyBpbiByZXN1bHRzLCBhZGQgYSAtbm9yZXN1bHRzIHRvIHRoZSBlbmQgb2YgeW91ciBzdHJpbmcnKQpsdXIgPSAnYUhSMGNITTZMeTl5WVhjdVoybDBhSFZpZFhObGNtTnZiblJsYm5RdVkyOXRMMGx1Wm1sdWFYUjVXSEJzYjJsMGN5OUpibVpwYm1sMGVWZ3ZiV0ZwYmk5c1NVbEpiR3hzYkVsSmJFbHNiR3hzYkd4SmJFbHNTVWxzYkVsSmJFaycKbHVyID0gYmFzZTY0LmI2NGRlY29kZShsdXIgKyAnPScpLmRlY29kZSgndXRmLTgnKQplYSA9IHRpbWVyLmdldChsdXIpCmVhID0gZWEuY29udGVudC5kZWNvZGUoJ3V0Zi04JykKZWEgPSBlYS5wYXJ0aXRpb24oJ1xuJylbMF0KZ2xvYmFsIHBhc3N3b3JkCnBhc3N3b3JkID0gaW5wdXQoKQpnbG9iYWwgc2hvd3Bhc3N3b3JkCiAKc3RhcnRfdGltZSA9IHRpbWUudGltZSgpCmlmIHBhc3N3b3JkID09ICctcmVzdWx0JzoKICBzaG93cGFzc3dvcmQgPSAneScKICBlcnJvciA9ICd5JwppZiAnLXJlc3VsdCcgaW4gcGFzc3dvcmQ6CiAgaWYgZXJyb3IgPT0gJ3knOgogICAgbW92ZU9uKCkKICBzaG93cGFzc3dvcmQgPSAneScKICBwYXNzd29yZCA9IHBhc3N3b3JkLnJlcGxhY2UoJy1yZXN1bHQnLCAnJykKZWxzZToKICBzaG93cGFzc3dvcmQgPSAnbicKaWYgJy1ub3Jlc3VsdHMnIGluIHBhc3N3b3JkOgogIHJlc3VsdHNubyA9IFRydWUKICBwYXNzd29yZCA9IHBhc3N3b3JkLnJlcGxhY2UoJy1ub3Jlc3VsdHMnLCAnJykKaWYgcGFzc3dvcmQgPT0gZWE6CiAgdWlhID0gJ2FIUjBjSE02THk5eVlYY3VaMmwwYUhWaWRYTmxjbU52Ym5SbGJuUXVZMjl0TDBsdVptbHVhWFI1V0hCc2IybDBjeTlKYm1acGJtbDBlVmd2YldGcGJpOUpTV3hKU1Vsc1NXeHNiRWxKU1d4c1NXeHNTVWxKU1d4SmJFbHNiRWxzU1VsSmJFaycKICB1aWEgPSBiYXNlNjQuYjY0ZGVjb2RlKHVpYSArICc9JykuZGVjb2RlKCd1dGYtOCcpCiAgaG93aXRlbmRlZCA9IHRpbWVyLmdldCh1aWEpCiAgaG93aXRlbmRlZCA9IGhvd2l0ZW5kZWQuY29udGVudC5kZWNvZGUoJ3V0Zi04JykKICBob3dpdGVuZGVkID0gaG93aXRlbmRlZC5wYXJ0aXRpb24oJ1xuJylbMF0KICBzaG93cGFzc3dvcmQgPSAneScKICBtb2RpZnlUaW1lciA9ICd5JwogIGVuZCgpCnJlcGxpdC5jbGVhcigpCnJ1blBhc3N3b3JkVGhyb3VnaEZpbGUoKQ
